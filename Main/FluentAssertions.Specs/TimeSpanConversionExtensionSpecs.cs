using System;

using FluentAssertions.Assertions;
using FluentAssertions.Common;

using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace FluentAssertions.specs
{
    [TestClass]
    public class TimeSpanConversionExtensionSpecs
    {
        [TestMethod]
        public void When_getting_the_number_of_days_it_should_return_the_correct_time_span_value()
        {
            //-----------------------------------------------------------------------------------------------------------
            // Act
            //-----------------------------------------------------------------------------------------------------------
            TimeSpan time = 4.Days();

            //-----------------------------------------------------------------------------------------------------------
            // Assert
            //-----------------------------------------------------------------------------------------------------------
            Assert.AreEqual(new TimeSpan(4, 0, 0, 0), time);
        }

        [TestMethod]
        public void When_getting_the_number_of_hours_it_should_return_the_correct_time_span_value()
        {
            //-----------------------------------------------------------------------------------------------------------
            // Act
            //-----------------------------------------------------------------------------------------------------------
            TimeSpan time = 4.Hours();

            //-----------------------------------------------------------------------------------------------------------
            // Assert
            //-----------------------------------------------------------------------------------------------------------
            Assert.AreEqual(new TimeSpan(4, 0, 0), time);
        }

        [TestMethod]
        public void When_getting_the_number_of_minutes_it_should_return_the_correct_time_span_value()
        {
            //-----------------------------------------------------------------------------------------------------------
            // Act
            //-----------------------------------------------------------------------------------------------------------
            TimeSpan time = 4.Minutes();

            //-----------------------------------------------------------------------------------------------------------
            // Assert
            //-----------------------------------------------------------------------------------------------------------
            Assert.AreEqual(new TimeSpan(0, 4, 0), time);
        }

        [TestMethod]
        public void When_getting_the_number_of_seconds_it_should_return_the_correct_time_span_value()
        {
            //-----------------------------------------------------------------------------------------------------------
            // Act
            //-----------------------------------------------------------------------------------------------------------
            TimeSpan time = 4.Seconds();

            //-----------------------------------------------------------------------------------------------------------
            // Assert
            //-----------------------------------------------------------------------------------------------------------
            Assert.AreEqual(new TimeSpan(0, 0, 4), time);
        }

        [TestMethod]
        public void When_getting_the_number_of_milliseconds_it_should_return_the_correct_time_span_value()
        {
            //-----------------------------------------------------------------------------------------------------------
            // Act
            //-----------------------------------------------------------------------------------------------------------
            TimeSpan time = 4.Milliseconds();

            //-----------------------------------------------------------------------------------------------------------
            // Assert
            //-----------------------------------------------------------------------------------------------------------
            Assert.AreEqual(new TimeSpan(0, 0, 0, 0, 4), time);
        }

        [TestMethod]
        public void When_combining_fluent_time_methods_it_should_return_the_correct_time_span_value()
        {
            //-----------------------------------------------------------------------------------------------------------
            // Act
            //-----------------------------------------------------------------------------------------------------------
            TimeSpan time1 = 23.Hours().And(59.Minutes());
            TimeSpan time2 = 23.Hours(59.Minutes()).And(20.Seconds());
            TimeSpan time3 = 1.Days(2.Hours(33.Minutes(44.Seconds()))).And(99.Milliseconds());

            //-----------------------------------------------------------------------------------------------------------
            // Assert
            //-----------------------------------------------------------------------------------------------------------
            Assert.AreEqual(new TimeSpan(23, 59, 0), time1);
            Assert.AreEqual(new TimeSpan(23, 59, 20), time2);
            Assert.AreEqual(new TimeSpan(1, 2, 33, 44, 99), time3);
        }
    }
}